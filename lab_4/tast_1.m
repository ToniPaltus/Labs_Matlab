clc;
clear all;
close all;

a = -pi/2;
b = 0;

x = unifrnd(a, b, 1, 15);
disp(x(1:15));

f_x = density(x);%–ø–ª–æ—Ç–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ —É—Å–ª–æ–≤–∏—é
g_x = max(f_x);%–¥–ª—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–æ–π –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã mu

N = 10000;
X = zeros(1, N);
i = 1;
while (i<=N)
%–° –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ –æ–±—Ä–∞—Ç–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π 
    z_1 = rand;
    mu = z_1*(b-a)+a;%X'
    z_2 = rand;
    fi = z_2*g_x;%Y

    if (fi<=density(mu))
        X(i) = mu;
        i = i + 1;
    end
end

%–≥—Ä–∞—Ñ–∏–∫ —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–æ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ cos(x)
n = 20;%–∫–∞—Ä–º–∞–Ω–æ–≤
delta = (b-a)/n;%—à–∏—Ä–∏–Ω–∞ –∫–∞—Ä–º–∞–Ω–∞
c = a + delta/2:delta:b-delta/2;%–≤–µ–∫—Ç–æ—Ä —Ü–µ–Ω—Ç—Ä–æ–≤ –∫–∞—Ä–º–∞–Ω–æ–≤
h = hist(X, c);
f_exp = h/(N*delta);%–≤–µ–∫—Ç–æ—Ä –≤—ã—Å–æ—Ç –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å
f_teor = density(c);%–ø–ª–æ—Ç–Ω–æ—Å—Ç—å —Å–æs(x)

figure(1)
hold on;
title('–ì—Ä–∞—Ñ–∏–∫ —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–æ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ cos(x)')
xlabel('c');
ylabel('density');
bar(c, f_exp);%–≠–º–ø–µ—Ä–∏—á–µ—Å–∫–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å
plot(c, f_teor, 'r');%–ü–ª–æ—Ç–Ω–æ—Å—Ç—å —Åos(x)
grid on;
hold off;

%–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å - —ç—Ç–æ –∏–Ω—Ç–µ–≥—Ä–∞–ª –æ—Ç –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ 
j = 1;
p = zeros(1, N);
M = zeros(1, N);
i = a;
while(i < b)
    p(j) = integral(@density, i, i+delta);
    i = i + delta;
    j = j+1;
end
%–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞ = –∑–Ω–∞—á–µ–Ω–∏–µ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã => h
%X^2 –ø–æ N –µ—Å—Ç—å —Å—É–º–º–∞(h - N*p)^2/(N*p)
j = 1;
ksi = 0;
r = n;%–°–º–æ—Ç—Ä—è —Å–∫–æ–ª—å–∫–æ —á–∏—Å–ª–µ –≤ –≤—ã–±–æ—Ä–∫–µ
while(j < r)
    ksi = ksi + (h(j)-N*p(j))^2/(N*p(j));
    j = j + 1;
end
ksi2 = chi2inv(0.95, r - 1);

disp(['–ö—Ä–∏—Ç–µ—Ä–∏–π —Å–æ–≥–ª–∞—Å–∏—è ksi^2: ' num2str(ksi) ' < ' num2str(ksi2) ';']);
% –ó–Ω–∞—á–µ–Ω–∏–µ ùúíùëÅ2 —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–µ—Ç –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤—É ùúíùëÅ2 < ùúí2(ùëü ‚àí 1,1 ‚àí ùõΩ),
% –∑–Ω–∞—á–∏—Ç —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 0.95 
%–≥–∏–ø–æ—Ç–µ–∑–∞ –æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –∑–∞–∫–æ–Ω–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–¥–∞–Ω–Ω–æ–π —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã 
% –∏ —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã, –º–æ–¥–µ–ª–∏—Ä—É–µ–º–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–º, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è.

Q = sort(X);
w = 0;
i = 1;
while(i < N)
    w = w + (raspred(Q(i))-(i - 0.5)/N)^2;
    i = i + 1;
end
w = w + 1/(12*N);
disp(['–ö—Ä–∏—Ç–µ—Ä–∏–π —Å–æ–≥–ª–∞—Å–∏—è w^2: ' num2str(w) ' < ' num2str(0.46) ';']);
%–ï—Å–ª–∏ ùúîùëÅ2 < ùë•ùõΩ —Ç–æ 
%–≥–∏–ø–æ—Ç–µ–∑–∞ –æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ ùêπ(ùë•) –∏ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º–æ–π —Å–ª—É—á–∞–π–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è
